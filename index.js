var jsmodule=function(e){function t(t){for(var n,r,a=t[0],o=t[1],s=0,l=[];s<a.length;s++)r=a[s],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&l.push(i[r][0]),i[r]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n]);for(c&&c(t);l.length;)l.shift()()}var n={},i={0:0};var r={};var a={2:function(){return{"./index.js":{__wbindgen_string_new:function(e,t){return n[1].exports.__wbindgen_string_new(e,t)},__wbindgen_object_drop_ref:function(e){return n[1].exports.__wbindgen_object_drop_ref(e)},__wbg_call_34f87007c5d2a397:function(e,t,i){return n[1].exports.__wbg_call_34f87007c5d2a397(e,t,i)},__wbindgen_debug_string:function(e,t){return n[1].exports.__wbindgen_debug_string(e,t)},__wbindgen_throw:function(e,t){return n[1].exports.__wbindgen_throw(e,t)}}}}};function o(t){if(n[t])return n[t].exports;var i=n[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,o),i.l=!0,i.exports}o.e=function(e){var t=[],n=i[e];if(0!==n)if(n)t.push(n[2]);else{var s=new Promise((function(t,r){n=i[e]=[t,r]}));t.push(n[2]=s);var l,d=document.createElement("script");d.charset="utf-8",d.timeout=120,o.nc&&d.setAttribute("nonce",o.nc),d.src=function(e){return o.p+""+({}[e]||e)+".js"}(e);var c=new Error;l=function(t){d.onerror=d.onload=null,clearTimeout(u);var n=i[e];if(0!==n){if(n){var r=t&&("load"===t.type?"missing":t.type),a=t&&t.target&&t.target.src;c.message="Loading chunk "+e+" failed.\n("+r+": "+a+")",c.name="ChunkLoadError",c.type=r,c.request=a,n[1](c)}i[e]=void 0}};var u=setTimeout((function(){l({type:"timeout",target:d})}),12e4);d.onerror=d.onload=l,document.head.appendChild(d)}return({1:[2]}[e]||[]).forEach((function(e){var n=r[e];if(n)t.push(n);else{var i,s=a[e](),l=fetch(o.p+""+{2:"2fa08b1d0b3da1c426c0"}[e]+".module.wasm");if(s instanceof Promise&&"function"==typeof WebAssembly.compileStreaming)i=Promise.all([WebAssembly.compileStreaming(l),s]).then((function(e){return WebAssembly.instantiate(e[0],e[1])}));else if("function"==typeof WebAssembly.instantiateStreaming)i=WebAssembly.instantiateStreaming(l,s);else{i=l.then((function(e){return e.arrayBuffer()})).then((function(e){return WebAssembly.instantiate(e,s)}))}t.push(r[e]=i.then((function(t){return o.w[e]=(t.instance||t).exports})))}})),Promise.all(t)},o.m=e,o.c=n,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)o.d(n,i,function(t){return e[t]}.bind(null,i));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o.oe=function(e){throw console.error(e),e},o.w={};var s=window.webpackJsonpjsmodule=window.webpackJsonpjsmodule||[],l=s.push.bind(s);s.push=t,s=s.slice();for(var d=0;d<s.length;d++)t(s[d]);var c=l;return o(o.s=0)}([function(e,t,n){"use strict";n.r(t),n.d(t,"oauthCallback",(function(){return y})),n.d(t,"getPaperDocsWithApi",(function(){return v}));const i=n.e(1).then(n.bind(null,1));var r=null;const a=function(){var e={},t=[],n=0;const i={bullet:"itemize",number:"enumerate",quote:"quote",task:"itemize",taskdone:"itemize",indent:"indent"};var r=function(i){return function(r){if(!e.hasOwnProperty(r)){const d=r.match(/_([^_]+?_*)\.(png|jpg|jpeg|svg)$/i);if(d){const u=d[1];var a="."+d[2].toLowerCase();const m=".svg"===a;m&&(a=".png");for(var o=u+a,s=2;t.indexOf(o)>=0;)o=u+"-"+s+a,s+=1;t.push(o);const p=n;var l=c(r,"GET","arraybuffer").then(e=>e.response);m&&(l=l.then(e=>{if(n===p)return function(e){return new Promise((t,n)=>{var i=document.createElement("canvas"),r=new Image;r.style="max-width:2000px;max-height:3000px",r.onload=function(){i.setAttribute("width",""+r.width),i.setAttribute("height",""+r.height),i.getContext("2d").drawImage(r,0,0,r.width,r.height),URL.revokeObjectURL(r.src),i.toBlob(e=>{const n=new FileReader;n.onload=e=>{t(e.target.result)},n.readAsArrayBuffer(e)},"image/png")};const a=new Blob([e],{type:"image/svg+xml"});r.src=window.URL.createObjectURL(a)})}(e)})),e[r]=l.then(e=>{n===p&&i.register_image(r,o,new Uint8Array(e))})}}}};function a(n,r,a){function o(e){for(var t=e.firstChild;t;t=t.nextSibling)t.nodeType===Node.TEXT_NODE?r.write_escaped(t.textContent,0,0):t.nodeType===Node.ELEMENT_NODE&&s(t)}function s(n){if("H1"===n.tagName)r.write_raw("\\section{",3,0),o(n),r.write_raw("}",0,2),r.limit_newlines(2);else if("H2"===n.tagName)r.write_raw("\\subsection{",3,0),o(n),r.write_raw("}",0,2),r.limit_newlines(2);else if("SPAN"===n.tagName)n.classList.contains("ace-all-bold-hthree")?(r.write_raw("\\paragraph{",2,0),o(n.firstElementChild.firstElementChild),r.write_raw("}",0,1),r.limit_newlines(2)):n.classList.contains("inline-code")?(r.write_raw("\\texttt{",0,0),r.write_escaped(n.textContent,0,0),r.write_raw("}",0,0)):n.classList.contains("inline-latex")?(r.write_raw("$",0,0),r.write_raw(n.getAttribute("data-current-latex-value"),0,0),r.write_raw("$",0,0)):n.hasAttribute("data-faketext")||n.classList.contains("gallery-extraneous-space")||o(n);else if("I"===n.tagName)r.write_raw("\\emph{",0,0),o(n),r.write_raw("}",0,0);else if("B"===n.tagName)r.write_raw("\\textbf{",0,0),o(n),r.write_raw("}",0,0);else if("S"===n.tagName)r.write_raw("\\sout{",0,0),o(n),r.write_raw("}",0,0);else if("A"===n.tagName)r.write_raw("\\href{",0,0),r.write_escaped(n.href,0,0),r.write_raw("}{",0,0),o(n),r.write_raw("}",0,0);else if("IMG"===n.tagName){const i="figure-"+(l+=1)+".png";a||(t.push(i),e[i]=c(n.src,"GET","arraybuffer").then(e=>{r.register_image(i,"",new Uint8Array(e.response))})),r.write_raw((a?"":"%")+"\\includegraphics[width=\\textwidth]{figures/"+i+"}",2,2)}else if("TABLE"===n.tagName){var i=n.firstElementChild.firstElementChild.childElementCount;r.write_raw("\\begin{tabular}{"+"l".repeat(i)+"}",2,1),r.increase_indent();for(var s=n.firstElementChild.firstElementChild;s;s=s.nextElementSibling){for(var d=s.firstElementChild;d;d=d.nextElementSibling)d!==s.firstElementChild&&r.write_raw("& ",0,0),r.increase_indent(),o(d),r.decrease_indent(),r.add_newlines(1);s.nextElementSibling&&(s===n.firstElementChild.firstElementChild?r.write_raw("\\\\\\hline",0,0):r.write_raw("\\\\",0,0)),r.add_newlines(1)}r.decrease_indent(),r.write_raw("\\end{tabular}",0,2)}else n.classList.contains("gallery-drop-hint-container")||o(n)}var l=0;const d=(new DOMParser).parseFromString(n,"text/html").documentElement.getElementsByTagName("body")[0].querySelector(".hp-print-mode .ace-feature-bigtitle > .ace-editor > div:first-child");return r.write_raw("\\title{",0,0),o(d),r.write_raw("}\n\\maketitle",0,2),r.limit_newlines(2),function(e){for(var t=["indent"],n=[0],a=!1;e;){const d=e.firstElementChild,c=d&&"CODE"===d.tagName,u=d&&"UL"===d.tagName||"OL"===d.tagName;if(!c&&a&&(a=!1,r.write_raw("\\end{verbatim}",0,2)),!u)for(;0!==n[n.length-1];)r.decrease_indent(),r.decrease_indent(),r.limit_newlines(1),r.write_raw("\\end{"+t.pop()+"}",1,2),n.pop();if(c&&(a||(a=!0,r.write_raw("\\begin{verbatim}\n",2,0)),r.write_escaped(d.textContent,0,1)),u){var s=null,l=null;d.classList.forEach(e=>{var t;(t=e.match(/^listindent(\d+)$/))&&(s=parseInt(t[1])),(t=e.match(/^listtype-(indent|bullet|number|quote|task|taskdone)$/))&&(l=t[1])});const e=i[l];if(s&&e){for(;s<n[n.length-1]||"indent"!==e&&s===n[n.length-1]&&t[t.length-1]!==e;){r.decrease_indent();const e=t.pop();"quote"!==e&&r.decrease_indent(),r.limit_newlines(1),r.write_raw("\\end{"+e+"}",1,2),n.pop()}"indent"!==e&&(s>n[n.length-1]&&(t.push(e),n.push(s),r.write_raw("\\begin{"+e+"}",1===s?2:1,1),r.limit_newlines(1),r.increase_indent(),"quote"!==e&&r.increase_indent()),"quote"!==e?(r.decrease_indent(),"task"===l?r.write_raw("\\item[\\uncheckedbox] ",2,0):"taskdone"===l?r.write_raw("\\item[\\checkedbox] ",2,0):r.write_raw("\\item ",2,0),r.increase_indent(),r.limit_newlines(0)):r.add_newlines(1))}}c||(e.firstElementChild&&e.firstElementChild.classList.contains("ace-separator")?r.write_raw("\\medbreak\\hrule\\medbreak",2,2):""===e.textContent&&(e.firstElementChild&&"BR"===e.firstElementChild.tagName||"quote"==t[t.length-1])?r.add_newlines(2):(r.add_newlines(1),o(e))),e=e.nextElementSibling}}(d.nextElementSibling),r.write_raw("\\end{document}",2,1),r.clear_output()}return{generateLatex:function(i,o,s){e={},t=[],n+=1;try{URL.revokeObjectURL(document.getElementById("save-zip").href)}catch(e){}var l;if("markdown"==o?l=s.markdown_to_latex(i,r(s)):(s.clear_registered_images(),l=a(i,s,!1)),0!==t.length){document.getElementById("wait-zip").style.display="inline";const t=n;Promise.all(Object.values(e)).then((function(){if(n===t){var e;"markdown"==o?e=s.markdown_to_zipped_latex(i):(l=a(i,s,!0),e=s.latex_to_zipped_latex(l));const t=new Blob([e],{type:"application/zip"}),n=window.URL.createObjectURL(t);document.getElementById("save-zip").href=n,document.getElementById("wait-zip").style.display="none",document.getElementById("save-zip-container").style.display="inline"}}))}else document.getElementById("wait-zip").style.display="none";return l}}}();const o=(s=null,function(e){e.preventDefault();const t="https://www.dropbox.com/oauth2/authorize?client_id=ebapspmlhsl9rn9&response_type=token&redirect_uri=https%3A%2F%2Frobamler.github.io%2Fbluepaper%2Foauth-redirect.html&state=remember%3D"+!!document.getElementById("remember").checked;null===s||s.closed?null===(s=window.open(t,"authorize","width=730,height=700,location,status,resizable,scrollbars"))&&(location.href=t):s.focus()});var s;function l(e){const t=e.dataTransfer.items;1===t.length&&"file"===t[0].kind&&(e.stopPropagation(),e.preventDefault(),document.getElementById("drop-feedback").style.display="block",document.getElementById("main").classList.add("blurred"),e.dataTransfer.dropEffect="copy")}function d(e){e.stopPropagation(),e.preventDefault(),document.getElementById("drop-feedback").style.display="none",document.getElementById("main").classList.remove("blurred")}function c(e,t,n,i,r,a){return new Promise((function(o,s){var l=new XMLHttpRequest;if(l.open(t,e,!0),void 0!==n&&(l.responseType=n),void 0!==i&&l.setRequestHeader("Content-Type",i),void 0!==a)for(var d in a)a.hasOwnProperty(d)&&l.setRequestHeader(d,a[d]);l.onreadystatechange=function(e){this.readyState===XMLHttpRequest.DONE&&(this.status>=200&&this.status<300?o(this):s(this))},l.send(r||null)}))}async function u(e){k();const t=await function(e){return new Promise((function(t,n){var i=new FileReader;i.onload=function(e){return t(e.target.result)},i.readAsText(e)}))}(e),n=await i,r=a.generateLatex(t,"markdown",n);document.querySelector(".result").classList.add("solo"),document.getElementById("first-step-doclist").style.display="none";var o=document.getElementById("latex");o.value=r,document.getElementById("copy").style.visibility="visible",setTimeout((function(){o.scrollTo(0,0)}),0)}function m(e){d(e);const t=e.dataTransfer.items;1===t.length&&"file"===t[0].kind&&u(e.dataTransfer.files[0])}function p(e){u(e.target.files[0])}function f(e){e.preventDefault(),g(),document.execCommand("copy"),document.getElementById("confirm").innerText="✓ Text copied to clipboard.",document.getElementById("confirm").style.visibility="visible"}function h(e){document.getElementById("confirm").innerText='✓ ZIP file saved (check "Downloads" directory).',document.getElementById("confirm").style.visibility="visible"}function g(){var e=document.getElementById("latex");e.select(),e.setSelectionRange(0,999999),setTimeout((function(){e.scrollTo(0,0)}),0)}function y(e){r=e,w()}async function w(){document.getElementById("authorization-container").style.display="none",document.getElementById("doc_list").style.display="block",await Promise.all([_(),b()]),document.getElementById("wait-document").style.display="none"}async function _(){const e=await v("https://api.dropboxapi.com/2/paper/docs/list",{filter_by:"docs_accessed",sort_by:"modified",sort_order:"descending",limit:100});return Promise.all(e.doc_ids.map((e,t)=>(async function(e,t){var n="https://api.dropboxapi.com/2/paper/docs/download?reject_cors_preflight=true&authorization=Bearer%20"+encodeURIComponent(r)+"&arg="+encodeURIComponent(JSON.stringify({doc_id:e,export_format:"markdown"}));try{var i=await c(n,"POST","text","text/plain; charset=utf-8")}catch{console.log("Error while trying to download document meta data.")}const a=JSON.parse(i.getResponseHeader("dropbox-api-result"));I[e]={meta:a,markdown:i.response};const o=L(a.title,a.owner,e,t),s=document.getElementById("doc_table"),l=Array.prototype.find.call(s.childNodes,e=>"TR"===e.nodeName&&e.getAttribute("data-index")>t);s.insertBefore(o,l)})(e,t)))}async function b(){const e=(await v("https://api.dropboxapi.com/2/files/search",{path:"",query:".paper",mode:{".tag":"filename"}})).matches.filter(e=>e.metadata.export_info&&"html"===e.metadata.export_info.export_as&&e.metadata.name.match(/^.*.paper$/)).map(e=>({title:e.metadata.name.substr(0,e.metadata.name.length-6),path:e.metadata.path_display,date:new Date(e.metadata.server_modified)})).sort((e,t)=>t.date-e.date),t=document.getElementById("doc_table"),n=t.firstElementChild;for(var i of e){const e=L(i.title,null,i.path,0);t.insertBefore(e,n)}}async function v(e,t){const n=e+"?reject_cors_preflight=true&authorization=Bearer%20"+encodeURIComponent(r),i=new TextEncoder("utf-8").encode(JSON.stringify(t)).buffer;try{var a;try{a=await c(n,"POST","text","text/plain; charset=dropbox-cors-hack",i)}catch(e){a=e}var o=JSON.parse(a.response)}catch{return document.getElementById("wait-document").style.display="none",void(document.getElementById("error-document").style.display="table-row")}if(o.error)throw"invalid_access_token"===o.error[".tag"]?(document.getElementById("doc_list").style.display="none",document.getElementById("authorization-container").style.display="block"):(document.getElementById("wait-document").style.display="none",document.getElementById("error-document").style.display="table-row",document.getElementById("error-document-text").innerText="An unknown error occurred."),null;return o}var E,x,B,I={};function L(e,t,n,i){var r=document.createElement("tr");r.classList.add("document"),r.setAttribute("data-index",i),r.setAttribute("data-docid",n);var a=document.createElement("td");a.classList.add("list_icon");var o=document.createElement("img");o.src="document.svg",a.appendChild(o),r.appendChild(a);var s=document.createElement("td");if(s.classList.add("list_text"),s.appendChild(document.createTextNode(e)),null!==t){var l=document.createElement("div");l.classList.add("doc_owner"),l.appendChild(document.createTextNode(t)),s.appendChild(l)}return r.appendChild(s),r.addEventListener("click",E),r}function k(){document.getElementById("latex").value="Just a second ...",document.getElementById("copy").style.visibility="hidden",document.getElementById("save-zip-container").style.display="none",document.getElementById("wait-zip").style.display="none",document.getElementById("choice-manual").style.display="none",document.querySelector("#choice-oauth h2").style.display="none",document.querySelector("#choice-oauth .steps").classList.add("active"),document.getElementById("confirm").style.visibility="hidden"}[E,x]=(B=null,[async function(e){e.preventDefault(),k(),B&&B.classList.remove("selected"),(B=e.currentTarget).classList.add("selected");const t=await i,n=B.getAttribute("data-docid");var o;if(I[n]){const e=await I[n].markdown;if(n!==B.getAttribute("data-docid"))return;o=a.generateLatex(e,"markdown",t)}else{const e=await async function(e){const t={Authorization:"Bearer "+encodeURIComponent(r),"Dropbox-API-Arg":JSON.stringify({path:e})};return(await c("https://content.dropboxapi.com/2/files/export","POST","text",void 0,null,t)).response}(n);if(n!==B.getAttribute("data-docid"))return;o=a.generateLatex(e,"html",t)}var s=document.getElementById("latex");s.value=o,document.getElementById("copy").style.visibility="visible",setTimeout((function(){s.scrollTo(0,0)}),0)},function(e){e.preventDefault(),document.getElementById("choice-manual").style.display="block",document.getElementById("first-step-doclist").style.display="block",document.querySelector("#choice-oauth h2").style.display="block",document.querySelector("#choice-oauth .steps").classList.remove("active"),document.querySelector(".result").classList.remove("solo"),B&&B.classList.remove("selected")}]);const C=(T=null,function(e){var t=document.getElementById(location.hash.substring(1));if(t.classList.contains("highlighter")){var n=0;null!==T&&(clearTimeout(T),T=null,t.classList.remove("highlight"),n=200),setTimeout((function(){t.classList.add("highlight"),T=setTimeout((function(){T=null,t.classList.remove("highlight")}),4100)}),n),history.pushState(null,"","#")}});var T;document.addEventListener("DOMContentLoaded",(function(){window.onhashchange=C,document.getElementById("authorize").addEventListener("click",o),document.getElementById("latex").addEventListener("click",g),document.getElementById("copy").addEventListener("click",f),document.getElementById("save-zip").addEventListener("click",h),document.getElementById("back-to-start").addEventListener("click",x),document.body.addEventListener("dragover",l,!1),document.body.addEventListener("dragexit",d,!1),document.body.addEventListener("drop",m,!1),document.getElementById("files").addEventListener("change",p);const e=document.cookie.match(/(^|; ?)bluepaper_dropbox_access_tokens=([^;]+)/);if(e){document.cookie="bluepaper_dropbox_access_tokens="+e[2]+";max-age=31536000;secure;samesite=lax";const t=JSON.parse(decodeURIComponent(e[2]));r=t.tokens[t.last_used],w()}}))}]);