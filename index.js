var jsmodule=function(e){function t(t){for(var n,r,i=t[0],a=t[1],c=0,d=[];c<i.length;c++)r=i[c],Object.prototype.hasOwnProperty.call(o,r)&&o[r]&&d.push(o[r][0]),o[r]=0;for(n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n]);for(l&&l(t);d.length;)d.shift()()}var n={},o={0:0};var r={};var i={2:function(){return{"./index.js":{__wbindgen_string_new:function(e,t){return n[1].exports.__wbindgen_string_new(e,t)},__wbindgen_object_drop_ref:function(e){return n[1].exports.__wbindgen_object_drop_ref(e)},__wbg_call_34f87007c5d2a397:function(e,t,o){return n[1].exports.__wbg_call_34f87007c5d2a397(e,t,o)},__wbindgen_debug_string:function(e,t){return n[1].exports.__wbindgen_debug_string(e,t)},__wbindgen_throw:function(e,t){return n[1].exports.__wbindgen_throw(e,t)}}}}};function a(t){if(n[t])return n[t].exports;var o=n[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,a),o.l=!0,o.exports}a.e=function(e){var t=[],n=o[e];if(0!==n)if(n)t.push(n[2]);else{var c=new Promise((function(t,r){n=o[e]=[t,r]}));t.push(n[2]=c);var d,s=document.createElement("script");s.charset="utf-8",s.timeout=120,a.nc&&s.setAttribute("nonce",a.nc),s.src=function(e){return a.p+""+({}[e]||e)+".js"}(e);var l=new Error;d=function(t){s.onerror=s.onload=null,clearTimeout(u);var n=o[e];if(0!==n){if(n){var r=t&&("load"===t.type?"missing":t.type),i=t&&t.target&&t.target.src;l.message="Loading chunk "+e+" failed.\n("+r+": "+i+")",l.name="ChunkLoadError",l.type=r,l.request=i,n[1](l)}o[e]=void 0}};var u=setTimeout((function(){d({type:"timeout",target:s})}),12e4);s.onerror=s.onload=d,document.head.appendChild(s)}return({1:[2]}[e]||[]).forEach((function(e){var n=r[e];if(n)t.push(n);else{var o,c=i[e](),d=fetch(a.p+""+{2:"2bc3aac78e5a66d8091c"}[e]+".module.wasm");if(c instanceof Promise&&"function"==typeof WebAssembly.compileStreaming)o=Promise.all([WebAssembly.compileStreaming(d),c]).then((function(e){return WebAssembly.instantiate(e[0],e[1])}));else if("function"==typeof WebAssembly.instantiateStreaming)o=WebAssembly.instantiateStreaming(d,c);else{o=d.then((function(e){return e.arrayBuffer()})).then((function(e){return WebAssembly.instantiate(e,c)}))}t.push(r[e]=o.then((function(t){return a.w[e]=(t.instance||t).exports})))}})),Promise.all(t)},a.m=e,a.c=n,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)a.d(n,o,function(t){return e[t]}.bind(null,o));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a.oe=function(e){throw console.error(e),e},a.w={};var c=window.webpackJsonpjsmodule=window.webpackJsonpjsmodule||[],d=c.push.bind(c);c.push=t,c=c.slice();for(var s=0;s<c.length;s++)t(c[s]);var l=d;return a(a.s=0)}([function(e,t,n){"use strict";n.r(t),n.d(t,"getPaperDocs",(function(){return v}));const o=n.e(1).then(n.bind(null,1)),r=(i={},a=[],c=0,d=function(e){return function(t){if(!i.hasOwnProperty(t)){const c=t.match(/_([^_]+?)\.(png|jpg|jpeg)$/i);if(c){for(var n="."+c[2].toLowerCase(),o=c[1]+n,r=1;a.indexOf(o)>=0;)r+=1,o=c[1]+"-"+r+n;a.push(o),i[t]=function(e,t){return new Promise((function(t,n){var o=new XMLHttpRequest;o.open("GET",e,!0),o.responseType="arraybuffer",o.onload=function(e){this.status>=200&&this.status<300&&t(this.response)},o.send()}))}(t).then(n=>{e.register_image(t,o,new Uint8Array(n))})}}}},{markdownToLatex:function(e,t){i={},a=[],c+=1,document.getElementById("save-zip-container").style.display="none";const n=t.markdown_to_latex(e,d(t));if(0!==a.length){document.getElementById("wait-zip").style.display="inline";const n=c;Promise.all(Object.values(i)).then((function(){if(c===n){const n=t.markdown_to_zipped_latex(e),o=new Blob([n],{type:"application/zip"}),r=window.URL.createObjectURL(o);document.getElementById("save-zip").href=r,document.getElementById("wait-zip").style.display="none",document.getElementById("save-zip-container").style.display="inline"}}))}else document.getElementById("wait-zip").style.display="none";return n},generateZipFile:function(e){return e.markdown_to_zipped_latex(markdown)}});var i,a,c,d;const s=(l=null,function(e){e.preventDefault();const t="https://www.dropbox.com/oauth2/authorize?client_id=ebapspmlhsl9rn9&response_type=token&redirect_uri=https%3A%2F%2Frobamler.github.io%2Fbluepaper%2Foauth-redirect.html&state=remember%3D"+!!document.getElementById("remember").checked;null===l||l.closed?null===(l=window.open(t,"authorize","width=730,height=700,location,status,resizable,scrollbars"))&&(location.href=t):l.focus()});var l;function u(e){const t=e.dataTransfer.items;1===t.length&&"file"===t[0].kind&&(e.stopPropagation(),e.preventDefault(),document.getElementById("drop-feedback").style.display="block",document.getElementById("main").classList.add("blurred"),e.dataTransfer.dropEffect="copy")}function m(e){e.stopPropagation(),e.preventDefault(),document.getElementById("drop-feedback").style.display="none",document.getElementById("main").classList.remove("blurred")}async function p(e){const t=await function(e){return new Promise((function(t,n){var o=new FileReader;o.onload=function(e){return t(e.target.result)},o.readAsText(e)}))}(e),n=await o,i=r.markdownToLatex(t,n);B(),document.querySelector(".result").classList.add("solo"),document.getElementById("first-step-doclist").style.display="none";var a=document.getElementById("latex");a.value=i,setTimeout((function(){a.scrollTo(0,0)}),0)}function f(e){m(e);const t=e.dataTransfer.items;1===t.length&&"file"===t[0].kind&&p(e.dataTransfer.files[0])}function y(e){p(e.target.files[0])}function g(e){e.preventDefault(),b(),document.execCommand("copy"),document.getElementById("confirm").innerText="✓ Text copied to clipboard.",document.getElementById("confirm").style.visibility="visible"}function h(e){document.getElementById("confirm").innerText='✓ ZIP file saved (check "Downloads" directory).',document.getElementById("confirm").style.visibility="visible"}function b(){var e=document.getElementById("latex");e.select(),e.setSelectionRange(0,999999),setTimeout((function(){e.scrollTo(0,0)}),0)}async function v(e){document.getElementById("authorization-container").style.display="none",document.getElementById("doc_list").style.display="block";const t="https://api.dropboxapi.com/2/paper/docs/list?reject_cors_preflight=true&authorization=Bearer%20"+encodeURIComponent(e),n={filter_by:"docs_accessed",sort_by:"modified",sort_order:"descending",limit:100};try{var o=await fetch(t,{method:"POST",mode:"cors",cache:"no-cache",headers:{"Content-Type":"text/plain; charset=dropbox-cors-hack"},body:JSON.stringify(n)}),r=JSON.parse(await o.text())}catch{document.getElementById("wait-document").style.display="none",document.getElementById("error-document").style.display="table-row"}r.error?"invalid_access_token"===r.error[".tag"]?(document.getElementById("doc_list").style.display="none",document.getElementById("authorization-container").style.display="block"):(document.getElementById("wait-document").style.display="none",document.getElementById("error-document").style.display="table-row",document.getElementById("error-document-text").innerText="An unknown error occurred."):(await Promise.all(r.doc_ids.map((t,n)=>(async function(e,t,n){var o="https://api.dropboxapi.com/2/paper/docs/download?reject_cors_preflight=true&authorization=Bearer%20"+encodeURIComponent(e)+"&arg="+encodeURIComponent(JSON.stringify({doc_id:t,export_format:"markdown"}));try{var r=await fetch(o,{method:"POST",mode:"cors",cache:"no-cache",headers:{"Content-Type":"text/plain; charset=utf-8"}})}catch{console.log("Error while trying to download document meta data.")}const i=JSON.parse(r.headers.get("dropbox-api-result"));x[t]={meta:i,markdown:r.text()};var a=document.createElement("tr");a.classList.add("document"),a.setAttribute("data-index",n),a.setAttribute("data-docid",t);var c=document.createElement("td");c.classList.add("list_icon");var d=document.createElement("img");d.src="document.svg",c.appendChild(d),a.appendChild(c);var s=document.createElement("td");s.classList.add("list_text"),s.appendChild(document.createTextNode(i.title));var l=document.createElement("div");l.classList.add("doc_owner"),l.appendChild(document.createTextNode(i.owner)),s.appendChild(l),a.appendChild(s),a.addEventListener("click",_);const u=document.getElementById("doc_table"),m=Array.prototype.find.call(u.childNodes,e=>"TR"===e.nodeName&&e.getAttribute("data-index")>n);u.insertBefore(a,m)})(e,t,n))),document.getElementById("wait-document").style.display="none")}var _,w,E,x={};function B(){document.getElementById("choice-manual").style.display="none",document.querySelector("#choice-oauth h2").style.display="none",document.querySelector("#choice-oauth .steps").classList.add("active"),document.getElementById("confirm").style.visibility="hidden"}[_,w]=(E=null,[async function(e){e.preventDefault(),B(),E&&E.classList.remove("selected"),(E=e.currentTarget).classList.add("selected");const t=E.getAttribute("data-docid"),n=await x[t].markdown,i=await o;if(t!==E.getAttribute("data-docid"))return;const a=r.markdownToLatex(n,i);var c=document.getElementById("latex");c.value=a,setTimeout((function(){c.scrollTo(0,0)}),0)},function(e){e.preventDefault(),document.getElementById("choice-manual").style.display="block",document.getElementById("first-step-doclist").style.display="block",document.querySelector("#choice-oauth h2").style.display="block",document.querySelector("#choice-oauth .steps").classList.remove("active"),document.querySelector(".result").classList.remove("solo"),E&&E.classList.remove("selected")}]);const I=(k=null,function(e){var t=document.getElementById(location.hash.substring(1));if(t.classList.contains("highlighter")){var n=0;null!==k&&(clearTimeout(k),k=null,t.classList.remove("highlight"),n=200),setTimeout((function(){t.classList.add("highlight"),k=setTimeout((function(){k=null,t.classList.remove("highlight")}),4100)}),n),history.pushState(null,"","#")}});var k;document.addEventListener("DOMContentLoaded",(function(){window.onhashchange=I,document.getElementById("authorize").addEventListener("click",s),document.getElementById("latex").addEventListener("click",b),document.getElementById("copy").addEventListener("click",g),document.getElementById("save-zip").addEventListener("click",h),document.getElementById("back-to-start").addEventListener("click",w),document.body.addEventListener("dragover",u,!1),document.body.addEventListener("dragexit",m,!1),document.body.addEventListener("drop",f,!1),document.getElementById("files").addEventListener("change",y);const e=document.cookie.match(/(^|; ?)bluepaper_dropbox_access_tokens=([^;]+)/);if(e){document.cookie="bluepaper_dropbox_access_tokens="+e[2]+";max-age=31536000;secure;samesite=lax";const t=JSON.parse(decodeURIComponent(e[2]));v(t.tokens[t.last_used])}}))}]);